"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const execa = require('execa');
const Listr = require("listr");
const tasks_1 = require("../tasks");
const index_1 = require("../utils/index");
function npmDistTagRun(cli) {
    const { project, verbose, yarn } = cli.flags;
    const cmd = cli.input[1];
    const tag = cli.input[2];
    return index_1.findSubmodules(project)
        .then((opts) => {
        const tasks = new Listr([
            {
                title: 'Version all submodules',
                task: () => new Listr(opts.map(opt => ({
                    title: `npm dist-tag ${cmd} ${opt.pkg.name}@${opt.pkg.version}`,
                    task: () => tasks_1.npmDistTag({
                        yarn, cmd, tag,
                        module: opt.pkg.name,
                        version: opt.pkg.version
                    })
                })))
            }
        ], { renderer: verbose ? 'verbose' : 'default' });
        return tasks.run();
    });
}
exports.npmDistTagRun = npmDistTagRun;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlzdC10YWcuY29tbWFuZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tYW5kcy9kaXN0LXRhZy5jb21tYW5kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQy9CLCtCQUFnQztBQUNoQyxvQ0FBc0M7QUFDdEMsMENBQWdEO0FBRWhELHVCQUE4QixHQUFHO0lBQy9CLE1BQU0sRUFBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBQyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUM7SUFDM0MsTUFBTSxHQUFHLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN6QixNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRXpCLE1BQU0sQ0FBQyxzQkFBYyxDQUFDLE9BQU8sQ0FBQztTQUMzQixJQUFJLENBQUMsQ0FBQyxJQUFrQixFQUFFLEVBQUU7UUFDM0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUM7WUFDdEI7Z0JBQ0UsS0FBSyxFQUFFLHdCQUF3QjtnQkFDL0IsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksS0FBSyxDQUNuQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztvQkFDZixLQUFLLEVBQUUsZ0JBQWdCLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRTtvQkFDL0QsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLGtCQUFVLENBQUM7d0JBQ3JCLElBQUksRUFBRSxHQUFHLEVBQUUsR0FBRzt3QkFDZCxNQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJO3dCQUNwQixPQUFPLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPO3FCQUN6QixDQUFDO2lCQUNILENBQUMsQ0FBQyxDQUNKO2FBQ0Y7U0FDRixFQUFFLEVBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUMsQ0FBQyxDQUFDO1FBRWhELE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDckIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBekJELHNDQXlCQyJ9